<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="google-site-verification" content="sNVMg_J8ppGagpGgbVNzwkEAia307XEJgFhjRFnT3fY" />
    <link rel="icon" type="image/jpeg" href="top1.jpg">
    <title>R√°dio Top Itatiba FM - 91.5</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.2/color-thief.umd.js"></script>

    <style>
        :root { --azul-escuro: #0a0e27; --magenta: #b01a7a; --roxo-neon: #aa00ff; --dourado: #f3b644; --fundo-neon: #050816; --verde-whatsapp: #00ff55; --vermelho-no-ar: #ff0000; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background-color: var(--fundo-neon); color: #eee; scroll-behavior: smooth; overflow-x: hidden; transition: background 1s ease; }

        /* --- BOT√ÉO VS FLUTUANTE --- */
        .poll-float { 
            position: fixed; bottom: 25px; left: 25px; width: 65px; height: 65px;
            background: linear-gradient(135deg, var(--magenta), #5e0046);
            color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            z-index: 10001; box-shadow: 0 0 15px var(--magenta); cursor: pointer;
            border: 2px solid white; font-weight: 900; font-style: italic; font-size: 28px;
            transition: 0.3s; animation: pulse-vs 2s infinite; text-shadow: 2px 2px 0 #000;
        }

        /* --- MODAL BATALHA (VISUAL MODERNO) --- */
        .battle-container { display: flex; flex-direction: column; gap: 15px; width: 100%; }
        .battle-option { 
            background: rgba(255,255,255,0.05); border: 2px solid #444; border-radius: 12px; 
            padding: 15px; position: relative; overflow: hidden; transition: 0.3s; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
        }
        .battle-option:hover { border-color: var(--dourado); background: rgba(255,255,255,0.1); }
        .battle-bar-bg { position: absolute; bottom: 0; left: 0; height: 5px; width: 100%; background: #222; }
        .battle-bar-fill { height: 100%; background: var(--magenta); width: 0%; transition: width 1s ease-out; }
        .battle-name { font-size: 18px; font-weight: 900; text-transform: uppercase; color: white; }
        .btn-votar-label { background: var(--dourado); color: black; font-size: 10px; font-weight: 900; padding: 3px 8px; border-radius: 10px; margin-top: 5px; display: inline-block; }
        .vs-divider { text-align: center; font-weight: 900; color: #ff0000; font-size: 24px; font-style: italic; text-shadow: 0 0 10px red; margin: -5px 0; z-index: 10; }

        /* OUTROS ESTILOS MANTIDOS */
        .firework { position: fixed; width: 4px; height: 4px; border-radius: 50%; z-index: 9999; pointer-events: none; }
        @keyframes explode { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(30); opacity: 0; } }
        .noticias-ticker { background: #000; color: var(--dourado); padding: 10px 0; border-bottom: 2px solid var(--magenta); overflow: hidden; white-space: nowrap; font-weight: bold; font-size: 14px; text-transform: uppercase; display: flex; z-index: 900; }
        .ticker-label { background: var(--magenta); color: white; padding: 0 15px; z-index: 10; position: relative; box-shadow: 5px 0 10px rgba(0,0,0,0.5); display: flex; align-items: center; animation: pisca-plantao 1s infinite alternate; }
        @keyframes pisca-plantao { 0% { background: var(--magenta); box-shadow: 0 0 5px var(--magenta); } 100% { background: var(--vermelho-no-ar); box-shadow: 0 0 20px var(--vermelho-no-ar); } }
        .ticker-content { display: inline-block; padding-left: 100%; animation: ticker-move 90s linear infinite; }
        @keyframes ticker-move { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        .noticia-item { display: inline-block; padding: 0 50px; } .noticia-item span { color: var(--magenta); margin-right: 8px; }
        nav { background: rgba(10, 14, 39, 0.9); backdrop-filter: blur(15px); border-bottom: 1px solid rgba(176, 26, 122, 0.5); padding: 12px 0; display: flex; justify-content: center; align-items: center; gap: 10px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 25px rgba(0,0,0,0.8); width: 100%; }
        nav a { color: #ddd; text-decoration: none; font-weight: 800; text-transform: uppercase; font-size: 11px; transition: all 0.3s ease; padding: 8px 14px; border-radius: 20px; letter-spacing: 0.5px; position: relative; }
        nav a:hover, nav a:active { color: white !important; background: var(--magenta); box-shadow: 0 0 15px var(--magenta); transform: translateY(-2px); }
        .painel-tempo-real { background: rgba(255, 255, 255, 0.05); border: 2px solid var(--magenta); border-radius: 15px; padding: 12px; margin: 15px auto; max-width: 500px; display: flex; justify-content: space-around; align-items: center; color: white; animation: animacaoCores 5s infinite ease-in-out; transition: border-color 1s ease; }
        @keyframes animacaoCores { 0% { border-color: var(--magenta); box-shadow: 0 0 15px var(--magenta); } 50% { border-color: var(--dourado); box-shadow: 0 0 15px var(--dourado); } 100% { border-color: var(--magenta); box-shadow: 0 0 15px var(--magenta); } }
        .no-ar-indicator { display: flex; align-items: center; justify-content: center; gap: 15px; background: linear-gradient(90deg, #1a0000 0%, #3d0000 50%, #1a0000 100%); color: var(--vermelho-no-ar); font-weight: 900; text-transform: uppercase; letter-spacing: 2px; padding: 12px; border-radius: 12px; border: 2px solid var(--vermelho-no-ar); margin: 15px auto 10px auto; max-width: 600px; box-shadow: 0 0 20px rgba(255, 0, 0, 0.3); animation: broadcast-pulse 3s infinite alternate ease-in-out; }
        .pulsing-dot { width: 10px; height: 10px; background-color: var(--vermelho-no-ar); border-radius: 50%; box-shadow: 0 0 10px var(--vermelho-no-ar); animation: blink-fast 0.8s infinite alternate; }
        .video-embed-container { max-width: 600px; margin: 10px auto; padding: 0 10px; }
        .video-embed { position: relative; padding-bottom: 100%; height: 0; overflow: hidden; background: #000; border: 3px solid var(--magenta); box-shadow: 0 0 20px var(--magenta); border-radius: 15px; animation: video-glow 5s infinite alternate; transition: border-color 1s ease, box-shadow 1s ease; }
        @media (min-width: 768px) { .video-embed-container { max-width: 700px; } .video-embed { padding-bottom: 50%; } }
        .bg-blur-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; filter: blur(20px) brightness(0.6); z-index: 1; transition: background-image 0.5s ease; }
        .capa-tv-img { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); height: 90%; width: auto; aspect-ratio: 1/1; object-fit: cover; z-index: 2; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.3); transition: box-shadow 1s ease; }
        .player-bar { background: linear-gradient(90deg, #120c22 0%, #2e003e 100%); color: white; padding: 25px 15px; display: flex; flex-direction: column; align-items: center; gap: 15px; box-shadow: 0 -5px 30px rgba(0,0,0,0.9); border-top: 2px solid var(--magenta); position: relative; overflow: hidden; }
        #visualizer-canvas { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0.4; pointer-events: none; }
        .album-cover { width: 50px; height: 50px; background: #000; border-radius: 10px; border: 2px solid var(--magenta); display: flex; align-items: center; justify-content: center; overflow: hidden; box-shadow: 0 0 15px var(--magenta); flex-shrink: 0; z-index: 2;}
        .ouvintes-count { color: var(--dourado); font-weight: bold; font-size: 14px; text-shadow: 1px 1px 2px black; }
        .btn-player-modern { width: 70px; height: 70px; background: linear-gradient(135deg, var(--magenta), var(--roxo-neon)); border-radius: 50%; border: 2px solid var(--magenta); color: white; font-size: 28px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 25px rgba(176, 26, 122, 0.6); transition: all 0.3s ease; position: relative; z-index: 10; }
        #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(-45deg, #050816, #2e003e, #000000, #1a1a2e); background-size: 400% 400%; animation: gradientBG 10s ease infinite; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 20000; transition: 0.8s ease-in-out; text-align: center; }
        @keyframes pulse-vs { 0% { box-shadow: 0 0 0 0 rgba(176, 26, 122, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(176, 26, 122, 0); } 100% { box-shadow: 0 0 0 0 rgba(176, 26, 122, 0); } }
        @media (max-width: 600px) { nav { gap: 5px; flex-wrap: wrap; padding: 10px 5px; } nav a { font-size: 10px; padding: 6px 10px; } }
    </style>
</head>
<body>

    <div id="modal-container" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal" onclick="fecharModal()">√ó</span>
            <div class="modal-header"><h2 id="modal-title">T√≠tulo</h2></div>
            <div class="modal-body" id="modal-body"></div>
            <div class="carousel-nav" id="carousel-controls" style="display:none;">
                <button class="nav-btn" onclick="prevSlide()">‚ùÆ</button>
                <span class="nav-counter" id="slide-counter">1 / 10</span>
                <button class="nav-btn" onclick="nextSlide()">‚ùØ</button>
            </div>
        </div>
    </div>

    <div id="splash-screen">
        <div class="splash-content">
            <img src="top1.jpg" alt="R√°dio Top" class="splash-logo" style="width:220px; height:220px; border-radius:50%; border:4px solid var(--magenta); box-shadow: 0 0 50px var(--magenta); margin-bottom:30px; animation: pulse-beat 1.5s infinite;">
            <h1 style="color: white; margin-bottom: 15px; letter-spacing: 2px;">BEM-VINDO √Ä RADIO TOP ITATIBA!</h1>
            <p style="color: var(--dourado); font-weight: bold; margin-bottom: 25px;">A Conex√£o que te Move!</p>
            <button class="btn-entrar-top" onclick="iniciarSite()">ENTRAR AGORA</button>
        </div>
    </div>

    <a href="https://wa.me/5511945914382" class="whatsapp-float" target="_blank" style="position: fixed; width: 60px; height: 60px; bottom: 25px; right: 25px; background-color: var(--verde-whatsapp); color: #000; border-radius: 50px; display: flex; align-items: center; justify-content: center; z-index: 10001; animation: pulse-green 2s infinite; text-decoration: none; box-shadow: 0 0 20px rgba(0,255,85,0.4);">
        <svg style="width:35px;height:35px" viewBox="0 0 24 24"><path fill="currentColor" d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91 0-2.65-1.03-5.14-2.9-7.01A9.816 9.816 0 0 0 12.04 2m.01 1.67c2.2 0 4.26.86 5.82 2.42a8.225 8.225 0 0 1 2.41 5.83c0 4.54-3.7 8.23-8.24 8.23-1.48 0-2.93-.39-4.19-1.14l-.3-.17-3.12.82.83-3.04-.19-.3a8.209 8.209 0 0 1-1.26-4.38c0-4.54 3.7-8.24 8.24-8.24m-3.53 2.32c-.13 0-.34.05-.52.25-.19.21-.72.7-.72 1.71s.73 1.99.83 2.12c.11.13 1.44 2.19 3.48 3.07.48.21.86.34 1.15.43.49.15.94.13 1.29.08.39-.06 1.21-.5 1.38-.98.17-.48.17-.89.12-.98-.05-.09-.18-.14-.38-.24s-1.21-.6-1.4-.67c-.18-.07-.32-.1-.46.12-.14.21-.53.67-.65.81-.12.14-.24.16-.44.06s-.83-.31-1.58-.98c-.58-.52-.97-1.16-1.09-1.36-.11-.2-.01-.31.09-.41.09-.09.2-.24.3-.35.1-.11.14-.19.21-.32.07-.13.03-.25-.02-.35-.05-.1-.46-1.1-.63-1.51-.16-.4-.33-.35-.46-.35z"/></svg>
    </a>
    
    <div class="poll-float" onclick="abrirModal('getEnquete', 'BATALHA')">VS</div>

    <div class="banner-container"><img src="banner.jpg"></div>

    <nav>
        <a href="#">HOME</a>
        <a href="javascript:void(0)" id="btnInstalar" style="display:none;" onclick="instalarPWA()">BAIXAR APP</a>
        <a href="#pedido">PEDIR M√öSICA</a>
        <a href="#mural">MURAL</a>
    </nav>

    <div class="noticias-ticker">
        <div class="ticker-label">PLANT√ÉO TOP</div>
        <div class="ticker-content"><span class="noticia-item">Carregando not√≠cias...</span></div>
    </div>

    <div class="no-ar-indicator">
        <span class="pulsing-dot"></span> TRANSMISS√ÉO VIA SAT√âLITE - NO AR <span class="pulsing-dot"></span>
    </div>
    
    <div class="video-embed-container">
        <div class="video-embed">
            <div id="blur-bg" class="bg-blur-layer" style="background-image: url('top1.jpg');"></div>
            <img id="capa-album-tv" src="top1.jpg" class="capa-tv-img" alt="Capa do √Ålbum">
        </div>
    </div>

    <div class="player-bar">
        <canvas id="visualizer-canvas"></canvas>
        <div class="player-info">
            <div class="album-cover"><div class="bars"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div></div></div>
            <div style="text-align: left; flex: 1;">
                <span class="status-text">NO AR AGORA:</span>
                <span id="nome-musica" style="font-size: 18px; font-weight: bold; display: block; color:white; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 280px;">Buscando r√°dio...</span>
                <span class="ouvintes-count">üéß <span id="qtd-ouvintes">...</span> OUVINTES</span>
            </div>
        </div>
        <audio id="radio-top" crossorigin="anonymous"><source src="https://server27.srvsh.com.br:6674/stream" type="audio/mpeg"></audio>
        <div class="glass-controls">
            <button id="btn-player" class="btn-player-modern" onclick="togglePlay()">
                <svg id="icon-play" width="30" height="30" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
                <svg id="icon-pause" width="30" height="30" viewBox="0 0 24 24" fill="white" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
            </button>
            <input type="range" id="vol-control" class="custom-volume" min="0" max="1" step="0.1" value="0.3" onchange="changeVolume(this.value)">
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; width: 100%;">
            <a href="https://www.youtube.com/watch?v=HoP0JQ9MV6g" target="_blank" id="link-studio" class="btn-studio"><span class="dot"></span> STUDIO AO VIVO</a>
        </div>
    </div>

    <div class="painel-tempo-real">
        <div class="tempo-item"><span class="tempo-label">Itatiba Agora</span><span class="tempo-valor" id="clock">00:00:00</span></div>
        <div class="tempo-item"><span class="tempo-label" id="label-clima">FELIZ 2026!</span><span class="tempo-valor" id="temp-itatiba">üéÜ ü•Ç</span></div>
    </div>

    <div class="container">
        <h2 id="pedido" class="section-title">üéµ PE√áA SUA M√öSICA NO WHATSAPP</h2>
        <div class="painel-pedido">
            <input type="text" id="pedido-nome" class="mural-input" placeholder="Seu Nome">
            <input type="text" id="pedido-musica" class="mural-input" placeholder="M√∫sica / Cantor">
            <button onclick="enviarPedidoZap()" class="btn-pedido-zap">ENVIAR PEDIDO AGORA</button>
        </div>

        <h2 class="section-title">üèÜ TOP 5 - AS MAIS PEDIDAS</h2>
        <div id="ranking-container" class="ranking-box"></div>

        <h2 class="section-title">‚ú® DESTAQUES DA TOP</h2>
        <div class="grid-cards">
            <div class="card" onclick="abrirModal('getTopHits', 'TOP HITS 2026')">
                <img src="tophits.jpg"><h3>Top Hits</h3><span class="btn-neon">VER LISTA</span>
            </div>
            <div class="card" onclick="abrirModal('getEquipe', 'NOSSA EQUIPE')">
                <img src="nossa equipe.jpg"><h3>Nossa Equipe</h3><span class="btn-neon">LOCUTORES</span>
            </div>
        </div>
    </div>

    <script>
        const urlGoogle = "https://script.google.com/macros/s/AKfycbxDl8bLK77gE83X-X6Va8GK6lVGsJBVCukxL6DsLUy6RRpO78iqM7Z5sdu_U9tbA6oLUg/exec";
        let audio = document.getElementById('radio-top');
        let isPlaying = false;
        let modalData = []; let modalIndex = 0; let currentAction = '';
        const colorThief = new ColorThief();

        function togglePlay() {
            const btn = document.getElementById('btn-player');
            const iconPlay = document.getElementById('icon-play');
            const iconPause = document.getElementById('icon-pause');
            if(isPlaying) {
                audio.pause(); iconPlay.style.display = 'block'; iconPause.style.display = 'none';
                btn.classList.remove('playing-pulse'); isPlaying = false;
                document.querySelectorAll('.bar').forEach(b => b.style.animation = 'none');
            } else {
                audio.load(); audio.play(); iconPlay.style.display = 'none'; iconPause.style.display = 'block';
                btn.classList.add('playing-pulse'); isPlaying = true;
                document.querySelectorAll('.bar').forEach(b => b.style.animation = 'equalizer 1s infinite ease-in-out');
            }
        }

        function abrirModal(acao, titulo) {
            const modal = document.getElementById('modal-container');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            const controls = document.getElementById('carousel-controls');
            currentAction = acao; modalData = []; modalIndex = 0;
            modalTitle.innerText = "CARREGANDO...";
            modalBody.innerHTML = '<p style="text-align:center; color:white;">Buscando informa√ß√µes...</p>';
            controls.style.display = 'none'; modal.style.display = 'flex';

            if (acao === 'getEnquete') {
                modalTitle.innerText = "BATALHA"; 
                fetch(urlGoogle + "?action=getEnquete").then(r => r.json()).then(data => {
                    modalBody.innerHTML = `
                        <h3 style="color:var(--dourado); text-transform:uppercase; margin-bottom:20px; font-size:16px;">QUAL √â SEU RITMO FAVORITO?</h3>
                        <div class="battle-container">
                            <div class="battle-option" onclick="votarBatalha(1)">
                                <div class="battle-info"><span class="battle-name">${data.op1}</span><br><span class="btn-votar-label">VOTO ${data.op1}</span></div>
                                <span class="battle-perc">${data.porc1}%</span>
                                <div class="battle-bar-bg"><div class="battle-bar-fill" style="width:${data.porc1}%"></div></div>
                            </div>
                            <div class="vs-divider">VS</div>
                            <div class="battle-option" onclick="votarBatalha(2)">
                                <div class="battle-info"><span class="battle-name">${data.op2}</span><br><span class="btn-votar-label">VOTO ${data.op2}</span></div>
                                <span class="battle-perc">${data.porc2}%</span>
                                <div class="battle-bar-bg"><div class="battle-bar-fill" style="width:${data.porc2}%"></div></div>
                            </div>
                        </div>`;
                });
                return;
            }
            fetch(urlGoogle + "?action=" + acao).then(r => r.json()).then(data => {
                if(!data || data.length === 0) { modalBody.innerHTML = '<p>Nenhuma informa√ß√£o dispon√≠vel.</p>'; }
                else { modalData = data; modalTitle.innerText = titulo; renderSlide(); controls.style.display = 'flex'; }
            }).catch(() => { modalBody.innerHTML = '<p>Erro ao carregar dados.</p>'; });
        }

        function votarBatalha(opcao) {
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = '<p style="color:var(--verde-whatsapp); font-size:20px; font-weight:bold; text-align:center; padding:50px;">VOTO COMPUTADO! ‚úÖ</p>';
            fetch(urlGoogle, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ action: "votar_batalha", voto: opcao }) });
            setTimeout(fecharModal, 1500);
        }

        function iniciarSite() {
            const splash = document.getElementById('splash-screen');
            splash.style.transform = 'translateY(-100%)';
            splash.style.opacity = '0';
            setTimeout(() => { splash.style.display = 'none'; }, 1000); 
            togglePlay(); carregarConfig(); carregarRanking(); carregarAnuncios(); atualizarMetadados();
        }

        function atualizarMetadados() {
            const proxy = "https://api.codetabs.com/v1/proxy?quest=";
            const urlSong = encodeURIComponent("http://server27.srvsh.com.br:6674/currentsong?sid=1&t=" + Date.now());
            fetch(proxy + urlSong).then(r => r.text()).then(data => {
                let nome = data.trim();
                if (nome.includes("<html") || nome === "") nome = "R√°dio Top - A Conex√£o que te Move";
                document.getElementById('nome-musica').innerText = nome;
            }).catch(() => { document.getElementById('nome-musica').innerText = "R√°dio Top Itatiba"; });

            const urlOuvintes = encodeURIComponent("http://server27.srvsh.com.br:6674/7.html");
            fetch(proxy + urlOuvintes).then(r => r.text()).then(d => {
                 let p = d.split(',');
                 if(p.length > 0 && !d.includes("<html")) {
                     let num = parseInt(p[0]);
                     if (!isNaN(num)) document.getElementById('qtd-ouvintes').innerText = num + 125;
                 }
            });
        }

        function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString('pt-BR'); }
        function fecharModal() { document.getElementById('modal-container').style.display = 'none'; }
        setInterval(updateClock, 1000);
        setInterval(atualizarMetadados, 20000);
        
        // Fun√ß√µes de apoio (Vazias ou b√°sicas para manter a estrutura)
        function changeVolume(v) { audio.volume = v; }
        function carregarConfig() { fetch(urlGoogle + "?action=getConfig").then(r => r.json()).then(data => { document.getElementById('capa-album-tv').src = data.tv; }); }
        function carregarRanking() {} function carregarAnuncios() {}
    </script>
</body>
</html>
